<div class="absolute inset-0 bg-gray-900 flex items-center justify-center p-4 z-10">
  <div class="w-full max-w-2xl bg-black/40 rounded-lg p-8 backdrop-blur-md border border-white/20 text-white shadow-2xl animate-fade-in">
    
    @if(isLoading()) {
      <div class="flex flex-col items-center justify-center min-h-[400px]">
        <app-loading-spinner></app-loading-spinner>
        <p class="mt-4 text-xl text-white/80 animate-pulse">Forging your adventure...</p>
        <p class="mt-2 text-sm text-white/60">This may take a moment.</p>
      </div>
    } @else {
      <h1 class="text-3xl font-bold text-center mb-6">Set Up Your Adventure</h1>
      <form (ngSubmit)="onSubmit()" class="space-y-6">

        <!-- Genre -->
        <div>
          <label class="block text-sm font-medium text-white/70 mb-2">Genre</label>
          <div class="grid grid-cols-3 gap-2">
            @for(genre of genres; track genre) {
              <button type="button" 
                      (click)="config.genre = genre"
                      [class.bg-blue-600]="config.genre === genre"
                      [class.bg-white/10]="config.genre !== genre"
                      class="px-4 py-2 text-sm rounded-md hover:bg-blue-500 transition-colors">
                {{ genre }}
              </button>
            }
          </div>
          @if(config.genre === 'Custom') {
            <input type="text" [(ngModel)]="config.customGenre" name="customGenre" placeholder="Describe your own genre (e.g., 'Steampunk Egyptology')" class="mt-2 w-full bg-transparent border-b-2 border-white/30 focus:border-white p-2 outline-none transition-colors">
          }
        </div>

        <!-- Scenes & Difficulty -->
        <div class="grid grid-cols-2 gap-6">
          <div>
            <label class="block text-sm font-medium text-white/70 mb-2">Length (Key Scenes)</label>
            <select [(ngModel)]="config.scenes" name="scenes" class="w-full bg-white/10 p-2 rounded-md border border-white/20">
              <option [ngValue]="3">3</option>
              <option [ngValue]="5">5</option>
              <option [ngValue]="7">7</option>
              <option [ngValue]="9">9</option>
              <option [ngValue]="12">12</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-white/70 mb-2">Difficulty</label>
            <select [(ngModel)]="config.difficulty" name="difficulty" class="w-full bg-white/10 p-2 rounded-md border border-white/20">
              <option>Easy</option>
              <option>Medium</option>
              <option>Hard</option>
            </select>
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium text-white/70 mb-2">Estimated Completion Time</label>
          <select [(ngModel)]="config.completionTime" name="completionTime" class="w-full bg-white/10 p-2 rounded-md border border-white/20">
            <option value="Short">Quick (12 minutes)</option>
            <option value="Medium">Normal (31 minutes)</option>
            <option value="Long">Long (77 Minutes)</option>
          </select>
        </div>

        <div class="pt-4">
          <button type="submit" class="w-full bg-green-600 hover:bg-green-500 text-white font-bold py-3 px-4 rounded-lg text-lg transition-transform duration-200 hover:scale-105">
            Generate Adventure
          </button>
        </div>

      </form>
    }
    
    @if(error(); as errorMessage) {
      <div class="mt-4 p-3 bg-red-900/50 border border-red-500 text-red-300 text-center rounded-md">
        {{ errorMessage }}
      </div>
    }
  </div>
</div>

<style>
  .animate-fade-in {
    animation: fadeIn 0.5s ease-in-out;
  }
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
</style>